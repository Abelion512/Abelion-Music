<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Detail Lagu - Abelion Music Player</title>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#000000" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="icon" href="Icon.jpg" type="image/jpg">
  <style>
    /* paste seluruh CSS milikmu di sini (nggak aku ubah karena udah mantap),
       tapi aku tambahkan media query RESPONSIVE di bawah */
       
    @media (min-width: 768px) {
      .container {
        padding: 3rem;
        max-width: 650px;
        margin: auto;
      }

      .lyric-popup {
        height: 70vh;
        max-width: 700px;
        left: 50%;
        transform: translateX(-50%);
        border-radius: 15px 15px 0 0;
      }

      .album-art {
        max-width: 350px;
      }

      .song-info h2 {
        font-size: 2rem;
      }
    }
  </style>
</head>
<body>
  <!-- HTML struktur kamu tidak aku ubah, tetap pakai .container, tombol, audio, dll -->
  <!-- Aku hanya akan kasih skrip di bawah yang versi FIXED -->
  
  <!-- ... semua elemenmu tetap sama seperti semula ... -->

  <script defer>
    document.addEventListener("DOMContentLoaded", () => {
      const audio = document.getElementById("audio");
      const playPause = document.getElementById("playPause");
      const title = document.getElementById("title");
      const artist = document.getElementById("artist");
      const albumArt = document.getElementById("albumArt");
      const seekBar = document.getElementById("seekBar");
      const currentTime = document.getElementById("currentTime");
      const duration = document.getElementById("duration");
      const lyricLines = document.getElementById("lyricLines");

      const songs = [
        { title: "Unconditionally", artist: "Katy Perry", file: "music/lagu1.mp3" },
        { title: "Rewrite the Stars", artist: "James Arthur & Anne-Marie", file: "music/lagu2.mp3" },
        { title: "Yad", artist: "Ariana Grande", file: "music/lagu3.mp3" },
        { title: "I'll Do It", artist: "Heidi Montag", file: "music/lagu4.mp3" },
        { title: "On The Floor", artist: "JLo ft Pitbull", file: "music/lagu5.mp3" },
        { title: "Stereo Love", artist: "unknown", file: "music/lagu6.mp3" }
      ];

      let currentIndex = parseInt(localStorage.getItem("selectedIndex")) || 0;
      let lyrics = [];

      function formatTime(t) {
        if (isNaN(t)) return "0:00";
        const m = Math.floor(t / 60);
        const s = Math.floor(t % 60).toString().padStart(2, '0');
        return `${m}:${s}`;
      }

      function getLyrics(title) {
        const db = {
          "Unconditionally": [
            { time: 0, text: "🎵 Unconditionally - Katy Perry" },
            { time: 5, text: "Original lyrics go here..." }
          ],
          "Rewrite the Stars": [
            { time: 0, text: "🎵 Rewrite the Stars" },
            { time: 4, text: "Lyrics sample..." }
          ]
        };
        return db[title] || [{ time: 0, text: "No lyrics available" }];
      }

      function updateLyrics(current) {
        if (lyrics.length === 0) return;
        lyricLines.innerHTML = lyrics.map((line, i) => {
          const next = lyrics[i + 1]?.time || Infinity;
          const active = current >= line.time && current < next;
          return `<div class="lyric-line${active ? ' active' : ''}" onclick="document.getElementById('audio').currentTime=${line.time}">${line.text}</div>`;
        }).join("");
        const activeLine = lyricLines.querySelector(".lyric-line.active");
        if (activeLine) {
          activeLine.scrollIntoView({ behavior: "smooth", block: "center" });
        }
      }

      function loadSong(index) {
        const song = songs[index];
        title.textContent = "Loading...";
        artist.textContent = "Please wait...";
        albumArt.src = "image/doit.jpeg";
        audio.src = song.file;

        audio.onloadedmetadata = () => {
          title.textContent = song.title;
          artist.textContent = song.artist;
          seekBar.max = audio.duration;
          duration.textContent = formatTime(audio.duration);
          lyrics = getLyrics(song.title);
          updateLyrics(0);
        };
      }

      function togglePlayPause() {
        if (audio.paused) {
          audio.play();
          playPause.textContent = "⏸";
        } else {
          audio.pause();
          playPause.textContent = "▶";
        }
      }

      seekBar.addEventListener("input", () => {
        audio.currentTime = seekBar.value;
      });

      audio.addEventListener("timeupdate", () => {
        seekBar.value = audio.currentTime;
        currentTime.textContent = formatTime(audio.currentTime);
        updateLyrics(audio.currentTime);
      });

      audio.addEventListener("ended", () => {
        playPause.textContent = "▶";
      });

      playPause.addEventListener("click", togglePlayPause);

      loadSong(currentIndex);
    });
  </script>
</body>
</html>
